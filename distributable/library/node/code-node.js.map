{"version":3,"sources":["../../../source/library/node/code-node.js"],"names":["CodeNode","Node","constructor","node","option","getSource","_node","buffer","mustEscape","UnsupportedCodeTransformError","val","block","blockNode","BlockNode","_option","blockSource","isEmpty"],"mappings":";;;;;;;AACA;;AACA;;AAEA;;;;AAEA,MAAMA,QAAN,SAAuBC,aAAvB,CAA4B;AAE1BC,EAAAA,WAAW,CAACC,IAAD,EAAOC,MAAP,EAAe;AACxB,UAAMD,IAAN,EAAYC,MAAZ;AACD;;AAED,QAAMC,SAAN,GAAkB;AAEhB;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA,QAAI,KAAKC,KAAL,CAAWC,MAAf,EAAuB;AAErB;AAEA,UAAI,KAAKD,KAAL,CAAWE,UAAf,EAA2B;AACzB,cAAM,IAAIC,4DAAJ,CAAkC,KAAKH,KAAvC,CAAN;AACD,OAFD,MAEO;AAEL,eAAS;kCACiB,KAAKA,KAAL,CAAWI,GAAI;;;;;;oBADzC;AASD;AAEF,KAnBD,MAmBO;AAEL,UAAI,KAAKJ,KAAL,CAAWK,KAAf,EAAsB;AAEpB,YAAIC,SAAS,GAAG,IAAIC,kBAAJ,CAAc,KAAKP,KAAL,CAAWK,KAAzB,EAAgC,KAAKG,OAArC,CAAhB;AACA,YAAIC,WAAW,GAAGH,SAAS,CAACI,OAAV,GAAoB,EAApB,GAAyB,MAAMJ,SAAS,CAACP,SAAV,EAAjD;AAEA,eAAS,IAAG,KAAKC,KAAL,CAAWI,GAAI;sBACbK,WAAY;oBAD1B;AAID,OATD,MASO;AACL,eAAO,KAAKT,KAAL,CAAWI,GAAlB;AACD;AAEF;AAEF;;AAhEyB;;eAoEbV,Q","sourcesContent":["\nimport BlockNode from './block-node.js'\nimport Node from '../node.js'\n\nimport { UnsupportedCodeTransformError } from '../error/unsupported-code-transform-error.js'\n\nclass CodeNode extends Node {\n\n  constructor(node, option) {\n    super(node, option)\n  }\n\n  async getSource() {\n\n    // if (node.buffer) {\n    //   if (node.mustEscape) {\n    //     source.push(`_nodes = _nodes.concat(${node.val})`)\n    //   } else {\n    //     throw new UnSupportedError('Buffered unescaped source is unsupported.')\n    //   }\n    // } else {\n  \n    //   source.push(`${node.val}`)\n  \n    //   if (node.block) {\n    //     source.push('{')\n    //     this.processBlock(node.block, source)\n    //     source.push('}')\n    //   } else {\n    //     source.push('')\n    //   }\n  \n    // }\n  \n    if (this._node.buffer) {\n\n      // return `__node.push(${this._node.val})`\n\n      if (this._node.mustEscape) {\n        throw new UnsupportedCodeTransformError(this._node)\n      } else {\n\n        return  ` {\n                    let value = ${this._node.val}\n                    if (typeof value === 'string') {\n                      __node.push(...[__option.convertToNode(value)].flat())\n                    } else {\n                      __node.push(value)\n                    }\n                  }`\n\n      }\n\n    } else {\n\n      if (this._node.block) {\n\n        let blockNode = new BlockNode(this._node.block, this._option)\n        let blockSource = blockNode.isEmpty ? '' : await blockNode.getSource()\n  \n        return  ` ${this._node.val} { \n                    ${blockSource}\n                  }`\n\n      } else {\n        return this._node.val\n      }\n\n    }\n\n  }\n\n}\n\nexport default CodeNode"],"file":"code-node.js"}